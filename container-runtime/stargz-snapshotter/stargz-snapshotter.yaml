name: stargz-snapshotter
depends:
  - service: cri
container:
  entrypoint: /usr/local/bin/busybox
  args:
    - nsenter
    - --mount=/proc/1/ns/mnt
    - /usr/local/bin/containerd-stargz-grpc
    - --address=/run/containerd-stargz-grpc/containerd-stargz-grpc.sock
    - --log-level=debug
  mounts:
    - source: /usr/local/bin
      destination: /usr/local/bin
      type: bind
      options:
        - rshared
        - rbind
        - rw
    - source: /proc
      destination: /proc
      type: bind
      options:
        - rshared
        - rbind
        - rw
restart: always
